/*!
 * ar-easy-validator v2.0.0
 * (c) 2020-2021 Armouy
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Validator=t()}(this,(function(){"use strict";const e={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外 "},t=[">","<",">=","<=","==","==="],r={is_email:/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/,is_mobile:/^1[3456789][0-9]{9}$/,is_concat:/(^(\d{3,4}-)?\d{6,8}$)|(^1[3456789][0-9]{9}$)/,is_name:/^[\u4E00-\u9FA5]{2,4}$/,is_number:/^\d+$|^\d*\.\d+$/,is_bankcard:/^[0-9]{16,19}$/,is_age:/^(?:[1-9][0-9]?|1[01][0-9]|120)$/,is_money:/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/,is_positive_int:/^[0-9]+$/,is_chinese:/^[\u4E00-\u9FA5]+$/,is_english:/^[A-Za-z]+$/,is_url:/[a-zA-z]+:\/\/[^\s]/,is_id:/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])\d{3}(\d|[xX])$/},i=e=>{const t=typeof e;return!!("undefined"===t||"string"===t&&0===e.length||"object"===t&&!e||"object"===t&&Array.isArray(e)&&0===e.length||"object"===t&&0===Object.keys(e).length)},s=(e,t)=>e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t,n=(e,t)=>{if(s(e,t))return!0;if("object"!=typeof e||null===e||"object"!==t||null===t)return!1;const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(let i=0;i<r.length;i++){const n=r[i];if(!Object.prototype.hasOwnProperty.call(t,n)||!s(e[n],t[n]))return!1}return!0},o=e=>!i(e);var l={isRequired:o,isEmpty:i,isEqual:n,isEmail:e=>r.is_email.test(e),isMobile:e=>r.is_mobile.test(e),isConcat:e=>r.is_concat.test(e),isWx:e=>r.is_mobile.test(e)||/^[a-zA-Z][a-zA-Z\d_-]{5,19}$/.test(e),isName:e=>r.is_name.test(e),isNumber:e=>r.is_number.test(e),isPositiveInt:e=>r.is_positive_int.test(e),isBankcard:e=>r.is_bankcard.test(e),isAge:e=>r.is_age.test(e),isMoney:e=>r.is_money.test(e),isChinese:e=>r.is_chinese.test(e),isEnglish:e=>o(e)&&r.is_english.test(e),isUrl:e=>r.is_url.test(e),isIdcard:t=>{const s=e;let n=!0;if(!i(t)&&r.is_id.test(t)&&s[t.substr(0,2)]){if(18==t.length){t=t.split("");const e=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],r=[1,0,"X",9,8,7,6,5,4,3,2];let i=0,s=0,o=0;for(let r=0;r<17;r++)s=Number(t[r]),o=e[r],i+=s*o;r[i%11]!=t[17].toUpperCase()&&(n=!1)}return null!=t&&n}return!1}};function a(e){return"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,r,i){if(!e||"string"!=typeof e)throw new Error("field is invaild in rules's item");if(t&&u.call(this,t),r&&!Array.isArray(r))throw new Error("need is invaild in rules's item");if(i&&"string"!=typeof i)throw new Error("tip is invaild in rules's item")}function u(e){const r=typeof e;if("string"!==r&&!a(e)&&!Array.isArray(e))throw new Error("rules should be string or object or array");if(!("string"!==r||"validate"!==e&&"addRule"!==e&&this.hasOwnProperty(e)))throw new Error("rules doesn't exist");if("object"!==r||Array.isArray(e)){if(Array.isArray(e)&&e.length>0)for(let t=0;t<e.length;t++){const r=e[t];if("string"!=typeof r&&!a(r))throw new Error("when rules is an array, it' children should be string or an object");u.call(this,r)}}else{const r=Object.keys(e);if(0===r.length||r.length>1)throw new Error("rules is invaild");if(!t.includes(r[0]))throw new Error(`when rules is an object, rules'key should be on of [ ${t.join(", ")} ]`)}}function f(e,t){if("string"===typeof t)return d.call(this,e,t);if(Array.isArray(t))return y.call(this,e,t);{const r=Object.keys(t)[0];return h(e,r,t[r])}}function d(e,t){return this[t](e)}function h(e,t,r){switch(t){case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r;case"==":return e==r;default:return"object"!=typeof e||Array.isArray(e)?n(e,r):e===r}}function y(e,t){let r=!0;for(let i=0;i<t.length;i++){const s=t[i],n=typeof s;if("string"===n)r=d.call(this,e,s);else if("object"===n&&!Array.isArray(s)){const t=Object.keys(s)[0];r=h(e,t,s[t])}if(!r)return!1}return!0}function b(e,t,r,i){let s=!0;if(i&&i.length>0)for(let t=0;t<i.length;t++){const r=i[t];if(!r.hasOwnProperty("field"))throw new Error("field isn't exist");let{field:n,rules:o}=r;if(o||(o="isRequired"),c.call(this,n,o),e.hasOwnProperty(n)){const t=e[n];s=f.call(this,t,o)}}return!s||(r||(r="isRequired"),f.call(this,t,r))}function p(e,t){try{!function(e,t){if(!e||!a(e))throw new Error("parameter values is invalid in validate, it should be an object");if(!Array.isArray(t))throw new Error("parameter rules is invalid in validate, it should be an array")}(e,t);for(let r=0;r<t.length;r++){const i=t[r];if(!i.hasOwnProperty("field"))throw new Error("field isn't exist");const{field:s,rules:n,need:o,tip:l}=i;if(c.call(this,s,n,o,l),e.hasOwnProperty(s)){if(b.call(this,e,e[s],n,o))return{res:!0,msg:"success"};return{res:!1,msg:l||`${s} is error`}}}}catch(e){return{res:!1,msg:"failure"}}}function g(){Object.keys(l).forEach((e=>{this[e]=l[e]})),this.validate=p.bind(this)}g.prototype.addRule=function(e,t){try{if(!e||"string"!=typeof e||"validate"===e||"addRule"===e)throw new Error("parameter \"key\" is invaild in addRule, \n        it should be string, and not allow be named 'validate' or 'addRule'. ");if(!t||"function"!=typeof t)throw new Error('parameter "cb" is invaild in addRule, it should be a function. ');this[e]=t}catch(e){}};return new g}));
